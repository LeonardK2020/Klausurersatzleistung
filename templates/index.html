<html>
    <head>
     {{bootstrap.load_css()}}
        <link rel="stylesheet" href="{{ url_for('static', filename= 'css/index.css') }}">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
        <title>Jot All Life: The ultimate personal organizer</title>
    </head>


    <body id="body1"class="container shadow-lg" onLoad="uhrzeit(); initializeCalendar();">
        <nav id="nav" class="navbar sticky-top navbar-expand-lg" style="background-color: #5B6EC5;">
            <div class="container-fluid">
              <a class="navbar-brand">
                <img src="{{ url_for('static', filename= 'files/logoq2.PNG') }}" alt="Bootstrap" width="200" height="50">
                The ultimate personal organizer</a>
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                </ul>
                <form style="margin-top: 15px"name="uhr" class="text-center">
                    <h4><input type="button" class="btn btn-outline-light bi bi-clock" name="uhrbutton" value="00:00:00"/><i style="margin-left: 10px"class="bi bi-clock"></i></h4>
                </form>
                <div id="current_date"></p></div>
            </div>
        </nav>

       
            <div style="margin-top: 15px" id="aufgaben" class="col text-center container-fluid">
              <h2>Aufgaben</h2>
              <table id="aufgabentable"class="table mx-auto table table-borderless">
                <tr id="thead1">
                    <th>Aufgabe</th>
                    <th>Fälligkeitsdatum</th>
                    <th>Priorität</th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
                 {%for aufgabe in aufgaben%}
                    {% if aufgabe[3] == "Hoch" %}
                        <tr>
                            <td>{{aufgabe[0]}}</td>
                            <td>{{aufgabe[1]}}.{{aufgabe[2]}}.</td>
                            <td style="background-color: red;">{{aufgabe[3]}}</td>
                            <td>
                                <form method="POST" action="{{ url_for('edit_aufgabe', aufgaben_id=aufgabe[4], name=aufgabe[0]) }}">
                                <input class="btn btn-secondary" type="submit" value="Bearbeiten">
                                </form>
                            </td>
                            <td>
                                <form action="" method="post">
                                    <td><a href="/remove_aufgabe/{{aufgabe[4]}}" class="btn btn-danger bi bi-trash3"></a></td>
                                </form>
                            </td>
                        </tr>
                    {% elif aufgabe[3] == "Mittel" %}
                        <tr>
                            <td>{{aufgabe[0]}}</td>
                            <td>{{aufgabe[1]}}.{{aufgabe[2]}}.</td>
                            <td style="background-color: yellow;">{{aufgabe[3]}}</td>
                            <td>
                                <form method="POST" action="{{ url_for('edit_aufgabe', aufgaben_id=aufgabe[4], name=aufgabe[0]) }}">
                                <input class="btn btn-secondary" type="submit" value="Bearbeiten">
                                </form>
                            </td>
                            <td>
                                <form action="" method="post">
                                    <td><a href="/remove_aufgabe/{{aufgabe[4]}}" class="btn btn-danger bi bi-trash3"></a></td>
                                </form>
                            </td>
                        </tr>
                    {% elif aufgabe[3] == "Niedrig" %}
                        <tr>
                            <td>{{aufgabe[0]}}</td>
                            <td>{{aufgabe[1]}}.{{aufgabe[2]}}.</td>
                            <td style="background-color: green;">{{aufgabe[3]}}</td>
                            <td>
                                <form method="POST" action="{{ url_for('edit_aufgabe', aufgaben_id=aufgabe[4], name=aufgabe[0]) }}">
                                <input class="btn btn-secondary" type="submit" value="Bearbeiten">
                                </form>
                            </td>
                            <td>
                                <form action="" method="post">
                                    <td><a href="/remove_aufgabe/{{aufgabe[4]}}" class="btn btn-danger bi bi-trash3"></a></td>
                                </form>
                            </td>
                        </tr>

                    {% elif aufgabe[3] == "None" %}
                        <tr>
                            <td>{{aufgabe[0]}}</td>
                            <td>{{aufgabe[1]}}.{{aufgabe[2]}}.</td>
                            <td style="background-color: rgb(255, 255, 255);">{{aufgabe[3]}}</td>
                            <td>
                                <form method="POST" action="{{ url_for('edit_aufgabe', aufgaben_id=aufgabe[4], name=aufgabe[0]) }}">
                                <input class="btn btn-secondary" type="submit" value="Bearbeiten">
                                </form>
                            </td>
                            <td>
                                <form action="" method="post">
                                    <td><a href="/remove_aufgabe/{{aufgabe[4]}}" class="btn btn-danger bi bi-trash3"></a></td>
                                </form>
                            </td>
                        </tr>
                    {% endif %}
                 {% endfor %}
            </table>
            <a href="/Aufgaben" class="btn btn-primary bi bi-plus"></a>
            </div>
            <div id="termine" style="margin-top: 30px" class="col text-center container-fluid">
              <h2>Termine</h2>
              <table class="table mx-auto table table-borderless">
                <tr id="thead2">
                    <th>Termin</th>
                    <th>Datum</th>
                    <th>Wochentag</th>
                    <th>Anfang</th>
                    <th>Ende</th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
                 {%for termin in termine%}
                    <tr>
                        <td>{{termin[0]}}</td>
                        <td>{{termin[1]}}.{{termin[2]}}.{{termin[3]}}</td>
                        <td>{{termin[4]}}</td>
                        <td>{{termin[5]}}</td>
                        <td>{{termin[6]}}</td>
                        <td>
                            <form method="POST" action="{{ url_for('edit_termin', termin_id=termin[7], name=termin[0]) }}">
                              <input class="btn btn-secondary"type="submit" value="Bearbeiten">
                            </form>
                        </td>
                        <td>
                            <form action="" method="post">
                                <td><a href="/remove_termin/{{termin[7]}}" class="btn btn-danger bi bi-trash3"></a></td>
                            </form>
                        </td>
                    </tr>
                 {% endfor %}
            </table>
            <a href="/Termine" class="btn btn-primary mt-3 mx-auto d-block bi bi-plus"></a>
            </div>
            <div id="calendar" style="margin-top: 30px" class="col text-center container-fluid border rounded">
              <h2>Kalender</h2>


              <div id="month-nav">
                <button id="prev-month">&lt;</button>
                <h2 id="current-month"></h2>
                <button id="next-month">&gt;</button>
              </div>
              
              <table style="margin: 0 auto">
                <thead>
                  <tr>
                    <th>Mo</th>
                    <th>Di</th>
                    <th>Mi</th>
                    <th>Do</th>
                    <th>Fr</th>
                    <th>Sa</th>
                    <th>So</th>
                  </tr>
                </thead>
                <tbody id="calendar-body">
                </tbody>
              </table>


            </div>


        
    </body>




</html>



<script>
//Uhrzeit
    function uhrzeit() {
        var act = new Date();
        var h= act.getHours();
        if  (h <10) { h="0"+h; }
        var m= act.getMinutes();
        if  (m <10) { m="0"+m; }
        var s= act.getSeconds();
        if  (s <10) { s="0"+s; }
        document.uhr.uhrbutton.value = h+":"+m+":"+s;
    }

    setInterval(uhrzeit, 1000);

//Datum
    date = new Date();
    year = date.getFullYear();
    month = date.getMonth() + 1;
    day = date.getDate();
    document.getElementById("current_date").innerHTML = day + "." + month + "." + year;


//Kalender
function showCalendar(year, month) {
  if (!year || !month) {
    let today = new Date();
    year = today.getFullYear();
    month = today.getMonth();
  }
  let calendarBody = document.getElementById('calendar-body');
  calendarBody.innerHTML = '';
  let date = new Date(year, month, 1);
  let daysInMonth = new Date(year, month + 1, 0).getDate();
  let firstDay = date.getDay();
  let currentMonth = document.getElementById('current-month');
  currentMonth.innerHTML = `${new Intl.DateTimeFormat('default', { month: 'long' }).format(date)} ${year}`;
  let dateNumber = 1;
  for (let i = 0; i < 6; i++) {
    let row = document.createElement('tr');
    for (let j = 0; j < 7; j++) {
      let cell = document.createElement('td');
      if (i === 0 && j < firstDay) {
        //tage vor 1. des monats
      } else if (dateNumber > daysInMonth) {
        //tage nach letzten des monats
      } else {
        cell.innerHTML = dateNumber;
        // "today" bei heutigem tag
        if (year === new Date().getFullYear() && month === new Date().getMonth() && dateNumber === new Date().getDate()) {
          cell.classList.add('today');
        }
        dateNumber++;
      }
      row.appendChild(cell);
    }
    calendarBody.appendChild(row);
  }

  let prevMonthButton = document.getElementById('prev-month');
  let nextMonthButton = document.getElementById('next-month');
  prevMonthButton.addEventListener('click', function() {
    showCalendar(year, month - 1);
  });
  nextMonthButton.addEventListener('click', function() {
    showCalendar(year, month + 1);
  });
}

showCalendar();

</script>

<!--Hier wird h/m/s <10 gesetzt, damit z.B. 10:09:17 und nicht 10:9:17 angezeigt wird-->